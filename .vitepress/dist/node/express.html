<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>well's blog | well's blog</title>
    <meta name="description" content="well's blog">
    <link rel="preload stylesheet" href="/blog/assets/style.01456bfa.css" as="style">
    
    <script type="module" src="/blog/assets/app.99e7a8b1.js"></script>
    <link rel="preload" href="/blog/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/blog/assets/chunks/framework.9adb0f96.js">
    <link rel="modulepreload" href="/blog/assets/chunks/theme.0198b334.js">
    <link rel="modulepreload" href="/blog/assets/node_express.md.9049c5ac.lean.js">
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-ffdc1df7><!--[--><!--]--><!--[--><span tabindex="-1" data-v-9c8615dd></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-9c8615dd> Skip to content </a><!--]--><!----><header class="VPNav" data-v-ffdc1df7 data-v-5bdc5df3><div class="VPNavBar has-sidebar" data-v-5bdc5df3 data-v-4077a65e><div class="container" data-v-4077a65e><div class="title" data-v-4077a65e><div class="VPNavBarTitle has-sidebar" data-v-4077a65e data-v-6d57964e><a class="title" href="/blog/" data-v-6d57964e><!--[--><!--]--><!----><!--[-->well&#39;s blog<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-4077a65e><div class="curtain" data-v-4077a65e></div><div class="content-body" data-v-4077a65e><!--[--><!--]--><div class="VPNavBarSearch search" style="--vp-meta-key:&#39;Meta&#39;;" data-v-4077a65e><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-4077a65e data-v-f732b5d0><span id="main-nav-aria-label" class="visually-hidden" data-v-f732b5d0>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/article/project/normalizeConfig.html" tabindex="0" data-v-f732b5d0 data-v-7f10a92a><!--[-->文档<!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/blog/node/nodeBasic.html" tabindex="0" data-v-f732b5d0 data-v-7f10a92a><!--[-->node<!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/interview/css.html" tabindex="0" data-v-f732b5d0 data-v-7f10a92a><!--[-->不止于面试<!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog/alg/array.html" tabindex="0" data-v-f732b5d0 data-v-7f10a92a><!--[-->算法<!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-4077a65e data-v-5e9f0637><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-5e9f0637 data-v-a99ed743 data-v-92d8f6fb><span class="check" data-v-92d8f6fb><span class="icon" data-v-92d8f6fb><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-a99ed743><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-a99ed743><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-4077a65e data-v-c8c2ae4b data-v-6afe904b><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-6afe904b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-6afe904b><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-6afe904b><div class="VPMenu" data-v-6afe904b data-v-e42ed9b3><!----><!--[--><!--[--><!----><div class="group" data-v-c8c2ae4b><div class="item appearance" data-v-c8c2ae4b><p class="label" data-v-c8c2ae4b>Appearance</p><div class="appearance-action" data-v-c8c2ae4b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-c8c2ae4b data-v-a99ed743 data-v-92d8f6fb><span class="check" data-v-92d8f6fb><span class="icon" data-v-92d8f6fb><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-a99ed743><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-a99ed743><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-4077a65e data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav reached-top" data-v-ffdc1df7 data-v-693d654a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-693d654a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-693d654a><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-693d654a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-693d654a data-v-bd10e8af><button data-v-bd10e8af>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-ffdc1df7 data-v-b04a928c><div class="curtain" data-v-b04a928c></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-b04a928c><span class="visually-hidden" id="sidebar-aria-label" data-v-b04a928c> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-b04a928c><section class="VPSidebarItem level-0 has-active" data-v-b04a928c data-v-66c2f55a><!----><div class="items" data-v-66c2f55a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-66c2f55a data-v-66c2f55a><div class="item" data-v-66c2f55a><div class="indicator" data-v-66c2f55a></div><a class="VPLink link link" href="/blog/node/nodeBasic.html" data-v-66c2f55a><!--[--><p class="text" data-v-66c2f55a>node 基础</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-66c2f55a data-v-66c2f55a><div class="item" data-v-66c2f55a><div class="indicator" data-v-66c2f55a></div><a class="VPLink link link" href="/blog/node/mongoDB.html" data-v-66c2f55a><!--[--><p class="text" data-v-66c2f55a>mongoDB</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link is-active has-active" data-v-66c2f55a data-v-66c2f55a><div class="item" data-v-66c2f55a><div class="indicator" data-v-66c2f55a></div><a class="VPLink link link" href="/blog/node/express.html" data-v-66c2f55a><!--[--><p class="text" data-v-66c2f55a>express</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-66c2f55a data-v-66c2f55a><div class="item" data-v-66c2f55a><div class="indicator" data-v-66c2f55a></div><a class="VPLink link link" href="/blog/node/koa.html" data-v-66c2f55a><!--[--><p class="text" data-v-66c2f55a>koa</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-ffdc1df7 data-v-f0629f57><div class="VPDoc has-sidebar has-aside" data-v-f0629f57 data-v-a3c25e27><!--[--><!--]--><div class="container" data-v-a3c25e27><div class="aside" data-v-a3c25e27><div class="aside-curtain" data-v-a3c25e27></div><div class="aside-container" data-v-a3c25e27><div class="aside-content" data-v-a3c25e27><div class="VPDocAside" data-v-a3c25e27 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-cb998dce data-v-c834746b><div class="content" data-v-c834746b><div class="outline-marker" data-v-c834746b></div><div class="outline-title" data-v-c834746b>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-c834746b><span class="visually-hidden" id="doc-outline-aria-label" data-v-c834746b> Table of Contents for current page </span><ul class="root" data-v-c834746b data-v-89c8d7c6><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-a3c25e27><div class="content-container" data-v-a3c25e27><!--[--><!--]--><!----><main class="main" data-v-a3c25e27><div style="position:relative;" class="vp-doc _blog_node_express" data-v-a3c25e27><div><h2 id="快速入门" tabindex="-1">快速入门 <a class="header-anchor" href="#快速入门" aria-label="Permalink to &quot;快速入门&quot;">​</a></h2><ul><li><a href="https://nodejs.cn/express/5x/api/app/" target="_blank" rel="noreferrer">应用</a><ul><li>通过调用 Express 模块导出的顶级express()函数来创建</li></ul></li><li><a href="https://nodejs.cn/express/5x/api/router/" target="_blank" rel="noreferrer">路由</a><ul><li>app.method(path, handler)</li></ul></li><li><a href="https://nodejs.cn/express/5x/api/req/#path" target="_blank" rel="noreferrer">请求</a><ul><li>handler参数，继承于 http.InComingMessage 类</li><li>常用属性 <ul><li>req.body</li><li>req.ip</li><li>req.baseUrl</li><li>req.query</li><li>...</li></ul></li></ul></li><li><a href="https://nodejs.cn/express/5x/api/res/" target="_blank" rel="noreferrer">响应</a><ul><li>handler 参数，继承于 http.ServerResponse 类</li><li>常用属性 <ul><li>res.json([body])</li><li>res.send([body])</li><li>res.status(code)</li><li>res.set(&#39;field&#39;[, value])</li><li>...</li></ul></li></ul></li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">const express = require(&#39;express&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">const app = express()</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 配置解析表单请求体：application/json</span></span>
<span class="line"><span style="color:#A6ACCD;">// 配置后可以通过 req.body 获取请求数据</span></span>
<span class="line"><span style="color:#A6ACCD;">app.use(express.json())</span></span>
<span class="line"><span style="color:#A6ACCD;">// 配置表单请求体：application/x-www-form-urlencoded</span></span>
<span class="line"><span style="color:#A6ACCD;">app.use(express.urlencoded())</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">app.get(&#39;/&#39;, (req, res) =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">    res.send(&#39;get&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">})</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">app.post(&#39;/todos/:id&#39;, async (req, res) =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">    const ret = await Promise.resolve({name: &#39;well&#39;})</span></span>
<span class="line"><span style="color:#A6ACCD;">    const { id } = req.params</span></span>
<span class="line"><span style="color:#A6ACCD;">    const { age } = req.body</span></span>
<span class="line"><span style="color:#A6ACCD;">    const { name } = ret</span></span>
<span class="line"><span style="color:#A6ACCD;">    res.send(`name：${name}，id：${id}，age：${age}`)</span></span>
<span class="line"><span style="color:#A6ACCD;">})</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">app.listen(3000, () =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">    console.log(&#39;server is running at 3000&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">})</span></span></code></pre></div><h2 id="中间件" tabindex="-1">中间件 <a class="header-anchor" href="#中间件" aria-label="Permalink to &quot;中间件&quot;">​</a></h2><ul><li>中间件函数 <ul><li>可以访问应用程序请求对象、响应对象和下一中间件函数的函数</li><li>下一中间件函数通常由一个名为<code>next</code>的变量表示</li><li>中间件函数可以执行的任务 <ul><li>执行任何代码</li><li>更改请求和响应对象</li><li>结束请求-响应周期</li><li>调用堆栈中下一个中间件函数</li></ul></li></ul></li><li>中间件分类 <ul><li>应用级中间件</li><li>路由级中间件</li><li>错误处理中间件</li><li>内置中间件</li><li>第三方中间件</li></ul></li><li>应用级中间件 <ul><li>使用<code>app.use()</code>和<code>app.method()</code>函数将应用级中间件绑定到<code>app对象实例</code></li><li><code>app.use(handler)</code></li><li><code>app.use(&#39;/user/:id&#39;, handler)</code></li><li><code>app.post(&#39;/user/:id&#39;, handler)</code></li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">const logTime = (req, res, next) =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">  console.log(`time：${Date.now()}`)</span></span>
<span class="line"><span style="color:#A6ACCD;">  next()</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">app.use(logTime, (req, res, next) =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">  console.log(&#39;middleware next&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">  next()</span></span>
<span class="line"><span style="color:#A6ACCD;">})</span></span></code></pre></div></li><li>路由级中间件 <ul><li>工作方式与应用级中间件相同，只是绑定到<code>express.Router()</code>的实例上</li><li><code>const router = express.Router()</code></li></ul></li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">// userRouter</span></span>
<span class="line"><span style="color:#A6ACCD;">const userRouter = require(&#39;./userRouter&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">// userRouter middleware</span></span>
<span class="line"><span style="color:#A6ACCD;">app.use(&#39;/user&#39;, userRouter)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// userRouter.js</span></span>
<span class="line"><span style="color:#A6ACCD;">const express = require(&#39;express&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">const userRouter = express.Router()</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">userRouter.get(&#39;/:id&#39;, (req, res) =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">  const { id } = req.params</span></span>
<span class="line"><span style="color:#A6ACCD;">  res.send(id)</span></span>
<span class="line"><span style="color:#A6ACCD;">})</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">module.exports = userRouter</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 访问 http://localhost:3000/user/110  &gt;&gt;&gt; 110</span></span></code></pre></div><ul><li>错误处理中间件 <ul><li>总是需要四个参数，必须提供四个参数</li></ul></li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">app.get(&#39;/&#39;, (req, res, next) =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">    try {</span></span>
<span class="line"><span style="color:#A6ACCD;">        throw new Error(&#39;测试错误&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">    } catch (error) {</span></span>
<span class="line"><span style="color:#A6ACCD;">        next(error)</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">})</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// error middleware</span></span>
<span class="line"><span style="color:#A6ACCD;">app.use((err, req, res, next) =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">    res.status(500).json({</span></span>
<span class="line"><span style="color:#A6ACCD;">        error: err.message</span></span>
<span class="line"><span style="color:#A6ACCD;">    })</span></span>
<span class="line"><span style="color:#A6ACCD;">})</span></span></code></pre></div><ul><li>内置中间件 <ul><li>express.json() <ul><li>解析 Content-Type 为application/json 格式的请求体</li></ul></li><li>express.urlencoded() <ul><li>解析 Content-Type 为 www-form-urlencoded 格式的请求体</li></ul></li><li>express.raw() <ul><li>解析 Content-Type 为 application/octet-stream 格式的请求体</li></ul></li><li>express.text() <ul><li>解析 Content-Type 为 text/plain 格式的请求体</li></ul></li><li>express.static() <ul><li>托管静态资源文件</li></ul></li></ul></li></ul><h2 id="restful-接口规范" tabindex="-1">RESTful 接口规范 <a class="header-anchor" href="#restful-接口规范" aria-label="Permalink to &quot;RESTful 接口规范&quot;">​</a></h2><ul><li><p>HTTP动词</p><ul><li>GET(读取)：从服务器取出资源（一项或多项）</li><li>POST(创建)：在服务器新建一个资源</li><li>PUT(完成更新)：在服务器更新资源（客户端提供改变后的完整资源）</li><li>PATCH(部分更新)：在服务器更新资源（客户端提供改变的属性）</li><li>DELETE(删除)：从服务器删除资源</li><li>HEAD: 获取资源的元数据</li><li>OPTIONS: 预检</li></ul></li><li><p>过滤信息</p><ul><li>?limit = 10 指定返回记录的数量</li><li>?offset= 10 指定返回的开始记录</li></ul></li><li><p>状态码</p><ul><li>1**: 相关信息</li><li>2**:操作成功</li><li>3**:重定向</li><li>4**:客户端错误</li><li>5**:服务器错误</li></ul></li><li><p>身份认证</p><p>基于 JWT 的接口权限认证：</p><ul><li>字段名：Authorization</li><li>字段值：Bearer token 数据</li></ul></li><li><p>跨域处理</p><ul><li>可以在服务端设置 CORS 设置客户端跨域资源请求</li></ul></li></ul><h2 id="restful-案例" tabindex="-1">RESTful 案例 <a class="header-anchor" href="#restful-案例" aria-label="Permalink to &quot;RESTful 案例&quot;">​</a></h2><h2 id="目录结构" tabindex="-1">目录结构 <a class="header-anchor" href="#目录结构" aria-label="Permalink to &quot;目录结构&quot;">​</a></h2><ul><li>config 配置文件 <ul><li>config.default.js</li></ul></li><li>controller 用于解析用户的输入，处理后返回相应的结果</li><li>model 数据持久层</li><li>middleware 用于编写中间件</li><li>router 用于配置 url 路由</li><li>util 工具模块</li><li>app.js 用于自定义启动</li></ul><h2 id="中间件与依赖资源" tabindex="-1">中间件与依赖资源 <a class="header-anchor" href="#中间件与依赖资源" aria-label="Permalink to &quot;中间件与依赖资源&quot;">​</a></h2><ul><li><p>解析请求体</p><ul><li>express.json()</li><li>express.urlencoded()</li></ul></li><li><p>日志输出</p><ul><li>morgan()</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm i morgan</span></span></code></pre></div></li><li><p>为客户端提供跨域资源请求</p><ul><li>cors()</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm i cors</span></span></code></pre></div></li><li><p>加密</p><ul><li>crypto</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm i crypto</span></span></code></pre></div></li><li><p>身份验证</p><ul><li>jsonwebtoken</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm install jsonwebtoken</span></span></code></pre></div></li><li><p>校验</p><ul><li>express-validator</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm i express-validator</span></span></code></pre></div></li><li><p>数据库</p><ul><li>mongoose</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm i mongoose</span></span></code></pre></div></li></ul><h2 id="入口" tabindex="-1">入口 <a class="header-anchor" href="#入口" aria-label="Permalink to &quot;入口&quot;">​</a></h2><ul><li>引入了路由模块，实现了路由的嵌套与代码分离</li><li>挂载了统一处理服务端错误中间件</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">const express = require(&#39;express&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 引入路由模块</span></span>
<span class="line"><span style="color:#A6ACCD;">const router = require(&#39;./router&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// cors 中间件</span></span>
<span class="line"><span style="color:#A6ACCD;">const cors = require(&#39;cors&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">// 自定义错误处理中间件</span></span>
<span class="line"><span style="color:#A6ACCD;">const errorHandler = require(&#39;./middleware/error-handler&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">const app = new express()</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 解析请求体</span></span>
<span class="line"><span style="color:#A6ACCD;">app.use(express.json())</span></span>
<span class="line"><span style="color:#A6ACCD;">app.use(express.urlencoded())</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 为客户端提供跨域</span></span>
<span class="line"><span style="color:#A6ACCD;">app.use(cors())</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">const PORT = p<wbr>rocess.env.PORT</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 挂载路由</span></span>
<span class="line"><span style="color:#A6ACCD;">app.use(&#39;/api&#39;, router)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 挂载统一处理服务端错误中间件</span></span>
<span class="line"><span style="color:#A6ACCD;">app.use(errorHandler())</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">app.listen(PORT, () =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">    console.log(`Server is running at http://localhost:${PORT}`)</span></span>
<span class="line"><span style="color:#A6ACCD;">})</span></span></code></pre></div><h2 id="路由模块" tabindex="-1">路由模块 <a class="header-anchor" href="#路由模块" aria-label="Permalink to &quot;路由模块&quot;">​</a></h2><ul><li>把<code>user</code>相关路由抽离到另一个文件了</li><li>使用 <code>validator</code>进行校验</li><li>使用<code>auth</code>进行身份验证</li><li>路由的进一步处理封装在<code>controller/user</code>中</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">// router/index.js</span></span>
<span class="line"><span style="color:#A6ACCD;">const express = require(&#39;express&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">const router = express.Router()</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 用户相关模块</span></span>
<span class="line"><span style="color:#A6ACCD;">router.use(require(&#39;./user&#39;))</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">module.exports = router</span></span></code></pre></div><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">// router/user.js</span></span>
<span class="line"><span style="color:#A6ACCD;">const express = require(&#39;express&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">const router = express.Router()</span></span>
<span class="line"><span style="color:#A6ACCD;">const userCtrl = require(&#39;../controller/user&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">const userValidator = require(&#39;../validator/user&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">const auth = require(&#39;../middleware/auth&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 用户登录</span></span>
<span class="line"><span style="color:#A6ACCD;">router.post(&#39;/users/login&#39;, userValidator.login, userCtrl.login)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 用户注册</span></span>
<span class="line"><span style="color:#A6ACCD;">router.post(&#39;/users&#39;, userValidator.register, userCtrl.register)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 获取当前登录用户</span></span>
<span class="line"><span style="color:#A6ACCD;">router.get(&#39;/user&#39;, auth, userCtrl.getCurrentUser)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 更新当前登录用户</span></span>
<span class="line"><span style="color:#A6ACCD;">router.put(&#39;/user&#39;, auth, userCtrl.updateCurrentUser)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">module.exports = router</span></span></code></pre></div><h2 id="validator-模块" tabindex="-1">validator 模块 <a class="header-anchor" href="#validator-模块" aria-label="Permalink to &quot;validator 模块&quot;">​</a></h2><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">const validate = require(&#39;../middleware/validate&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">const { body } = require(&#39;express-validator&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">const { User } = require(&#39;../model&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">const md5 = require(&#39;../util/md5&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">exports.register = validate([</span></span>
<span class="line"><span style="color:#A6ACCD;">    body(&#39;user.username&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">        .notEmpty()</span></span>
<span class="line"><span style="color:#A6ACCD;">        .withMessage(&#39;用户名不能为空&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">        .custom(async username =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">            const user = await User.findOne({ username })</span></span>
<span class="line"><span style="color:#A6ACCD;">            if (user) {</span></span>
<span class="line"><span style="color:#A6ACCD;">                return Promise.reject(&#39;用户名已存在&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">            }</span></span>
<span class="line"><span style="color:#A6ACCD;">        }),</span></span>
<span class="line"><span style="color:#A6ACCD;">    body(&#39;user.password&#39;).notEmpty().withMessage(&#39;密码不能为空&#39;),</span></span>
<span class="line"><span style="color:#A6ACCD;">    body(&#39;user.email&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">        .notEmpty()</span></span>
<span class="line"><span style="color:#A6ACCD;">        .withMessage(&#39;邮箱不能为空&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">        .isEmail()</span></span>
<span class="line"><span style="color:#A6ACCD;">        .withMessage(&#39;邮箱格式不正确&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">        .bail() // 前面两者都通过</span></span>
<span class="line"><span style="color:#A6ACCD;">        .custom(async email =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">            const user = await User.findOne({ email })</span></span>
<span class="line"><span style="color:#A6ACCD;">            if (user) {</span></span>
<span class="line"><span style="color:#A6ACCD;">                return Promise.reject(&#39;邮箱已存在&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">            }</span></span>
<span class="line"><span style="color:#A6ACCD;">        })</span></span>
<span class="line"><span style="color:#A6ACCD;">])</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">exports.login = [</span></span>
<span class="line"><span style="color:#A6ACCD;">    validate([</span></span>
<span class="line"><span style="color:#A6ACCD;">        body(&#39;user.email&#39;).notEmpty().withMessage(&#39;邮箱不能为空&#39;),</span></span>
<span class="line"><span style="color:#A6ACCD;">        body(&#39;user.password&#39;).notEmpty().withMessage(&#39;密码不能为空&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">    ]),</span></span>
<span class="line"><span style="color:#A6ACCD;">    validate([</span></span>
<span class="line"><span style="color:#A6ACCD;">        body(&#39;user.email&#39;).custom(async (email, { req }) =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">            const user = await User.findOne({ email }).select([&#39;email&#39;, &#39;username&#39;, &#39;bio&#39;, &#39;image&#39;, &#39;password&#39;])</span></span>
<span class="line"><span style="color:#A6ACCD;">            if (!user) {</span></span>
<span class="line"><span style="color:#A6ACCD;">                return Promise.reject(&#39;用户不存在&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">            }</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">            // 将数据挂载到请求对象中，后续的中间件也可以使用了</span></span>
<span class="line"><span style="color:#A6ACCD;">            req.user = user</span></span>
<span class="line"><span style="color:#A6ACCD;">        })</span></span>
<span class="line"><span style="color:#A6ACCD;">    ]),</span></span>
<span class="line"><span style="color:#A6ACCD;">    validate([</span></span>
<span class="line"><span style="color:#A6ACCD;">        body(&#39;user.password&#39;).custom(async (password, { req }) =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">            if (md5(password) !== req.user.password) {</span></span>
<span class="line"><span style="color:#A6ACCD;">                return Promise.reject(&#39;密码错误&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">            }</span></span>
<span class="line"><span style="color:#A6ACCD;">        })</span></span>
<span class="line"><span style="color:#A6ACCD;">    ])</span></span>
<span class="line"><span style="color:#A6ACCD;">]</span></span></code></pre></div><h2 id="controller-模块" tabindex="-1">controller 模块 <a class="header-anchor" href="#controller-模块" aria-label="Permalink to &quot;controller 模块&quot;">​</a></h2><ul><li>引用<code>model</code>层生成 Model构造函数，用于创建文档实例</li><li>引用<code>jwt</code>进行登录验证</li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">// 引入 user model</span></span>
<span class="line"><span style="color:#A6ACCD;">const { User } = require(&#39;../model&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">const jwt = require(&#39;../util/jwt&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">const { jwtSecret } = require(&#39;../config/config.default&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">//  用户登录</span></span>
<span class="line"><span style="color:#A6ACCD;">exports.login = async (req, res, next) =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">    try {</span></span>
<span class="line"><span style="color:#A6ACCD;">        // 1.数据验证</span></span>
<span class="line"><span style="color:#A6ACCD;">        // 2. 生成 token</span></span>
<span class="line"><span style="color:#A6ACCD;">        const user = req.user.toJSON()</span></span>
<span class="line"><span style="color:#A6ACCD;">        const token = await jwt.sign(</span></span>
<span class="line"><span style="color:#A6ACCD;">            {</span></span>
<span class="line"><span style="color:#A6ACCD;">                userId: user._id</span></span>
<span class="line"><span style="color:#A6ACCD;">            },</span></span>
<span class="line"><span style="color:#A6ACCD;">            jwtSecret,</span></span>
<span class="line"><span style="color:#A6ACCD;">            {</span></span>
<span class="line"><span style="color:#A6ACCD;">                expiresIn: &#39;24h&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">            }</span></span>
<span class="line"><span style="color:#A6ACCD;">        )</span></span>
<span class="line"><span style="color:#A6ACCD;">        // 3. 发送成功响应（包含 token 的用户信息）</span></span>
<span class="line"><span style="color:#A6ACCD;">        delete user.password</span></span>
<span class="line"><span style="color:#A6ACCD;">        res.status(200).json({</span></span>
<span class="line"><span style="color:#A6ACCD;">            ...user,</span></span>
<span class="line"><span style="color:#A6ACCD;">            token</span></span>
<span class="line"><span style="color:#A6ACCD;">        })</span></span>
<span class="line"><span style="color:#A6ACCD;">    } catch (error) {</span></span>
<span class="line"><span style="color:#A6ACCD;">        next(error)</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">//  用户注册</span></span>
<span class="line"><span style="color:#A6ACCD;">exports.register = async (req, res, next) =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">    try {</span></span>
<span class="line"><span style="color:#A6ACCD;">        const user = new User(req.body.user)</span></span>
<span class="line"><span style="color:#A6ACCD;">        await user.save()</span></span>
<span class="line"><span style="color:#A6ACCD;">        // 4.发送成功响应</span></span>
<span class="line"><span style="color:#A6ACCD;">        res.status(201).json({</span></span>
<span class="line"><span style="color:#A6ACCD;">            user</span></span>
<span class="line"><span style="color:#A6ACCD;">        })</span></span>
<span class="line"><span style="color:#A6ACCD;">    } catch (error) {</span></span>
<span class="line"><span style="color:#A6ACCD;">        next(error)</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 获取当前用户</span></span>
<span class="line"><span style="color:#A6ACCD;">exports.getCurrentUser = async (req, res, next) =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">    try {</span></span>
<span class="line"><span style="color:#A6ACCD;">        res.status(200).json({</span></span>
<span class="line"><span style="color:#A6ACCD;">            user: req.user</span></span>
<span class="line"><span style="color:#A6ACCD;">        })</span></span>
<span class="line"><span style="color:#A6ACCD;">    } catch (error) {</span></span>
<span class="line"><span style="color:#A6ACCD;">        next(error)</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 更新当前用户</span></span>
<span class="line"><span style="color:#A6ACCD;">exports.updateCurrentUser = async (req, res, next) =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">    try {</span></span>
<span class="line"><span style="color:#A6ACCD;">        // 处理请求</span></span>
<span class="line"><span style="color:#A6ACCD;">        res.send(&#39;updateCurrentUser&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">    } catch (error) {</span></span>
<span class="line"><span style="color:#A6ACCD;">        next(error)</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span></code></pre></div><h2 id="model-模块" tabindex="-1">model 模块 <a class="header-anchor" href="#model-模块" aria-label="Permalink to &quot;model 模块&quot;">​</a></h2><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">// model/index.js</span></span>
<span class="line"><span style="color:#A6ACCD;">const mongoose = require(&#39;mongoose&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">const { dbUri } = require(&#39;../config/config.default&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 连接 MongoDB 数据库</span></span>
<span class="line"><span style="color:#A6ACCD;">mongoose.connect(dbUri, {</span></span>
<span class="line"><span style="color:#A6ACCD;">    useNewUrlParser: true,</span></span>
<span class="line"><span style="color:#A6ACCD;">    useUnifiedTopology: true</span></span>
<span class="line"><span style="color:#A6ACCD;">})</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">const db = mongoose.connection</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 当连接失败的时候</span></span>
<span class="line"><span style="color:#A6ACCD;">db.on(&#39;error&#39;, err =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">    console.log(&#39;MongoDB 数据库连接失败&#39;, err)</span></span>
<span class="line"><span style="color:#A6ACCD;">})</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 当连接成功的时候</span></span>
<span class="line"><span style="color:#A6ACCD;">db.once(&#39;open&#39;, function () {</span></span>
<span class="line"><span style="color:#A6ACCD;">    console.log(&#39;MongoDB 数据库连接成功&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">})</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 组织导出模型类</span></span>
<span class="line"><span style="color:#A6ACCD;">module.exports = {</span></span>
<span class="line"><span style="color:#A6ACCD;">    User: mongoose.model(&#39;User&#39;, require(&#39;./user&#39;))</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span></code></pre></div><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">// model/user.js</span></span>
<span class="line"><span style="color:#A6ACCD;">const mongoose = require(&#39;mongoose&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">const baseModel = require(&#39;./base-model&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">const md5 = require(&#39;../util/md5&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">const userSchema = new mongoose.Schema({</span></span>
<span class="line"><span style="color:#A6ACCD;">    ...baseModel,</span></span>
<span class="line"><span style="color:#A6ACCD;">    username: {</span></span>
<span class="line"><span style="color:#A6ACCD;">        type: String,</span></span>
<span class="line"><span style="color:#A6ACCD;">        required: true</span></span>
<span class="line"><span style="color:#A6ACCD;">    },</span></span>
<span class="line"><span style="color:#A6ACCD;">    email: {</span></span>
<span class="line"><span style="color:#A6ACCD;">        type: String,</span></span>
<span class="line"><span style="color:#A6ACCD;">        required: true</span></span>
<span class="line"><span style="color:#A6ACCD;">    },</span></span>
<span class="line"><span style="color:#A6ACCD;">    password: {</span></span>
<span class="line"><span style="color:#A6ACCD;">        type: String,</span></span>
<span class="line"><span style="color:#A6ACCD;">        required: true,</span></span>
<span class="line"><span style="color:#A6ACCD;">        set: value =&gt; md5(value),</span></span>
<span class="line"><span style="color:#A6ACCD;">        select: false</span></span>
<span class="line"><span style="color:#A6ACCD;">    },</span></span>
<span class="line"><span style="color:#A6ACCD;">    bio: {</span></span>
<span class="line"><span style="color:#A6ACCD;">        type: String,</span></span>
<span class="line"><span style="color:#A6ACCD;">        default: null</span></span>
<span class="line"><span style="color:#A6ACCD;">    },</span></span>
<span class="line"><span style="color:#A6ACCD;">    image: {</span></span>
<span class="line"><span style="color:#A6ACCD;">        type: String,</span></span>
<span class="line"><span style="color:#A6ACCD;">        default: null</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">})</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">module.exports = userSchema</span></span></code></pre></div><h2 id="auth-模块与-jwt" tabindex="-1">auth 模块与 jwt <a class="header-anchor" href="#auth-模块与-jwt" aria-label="Permalink to &quot;auth 模块与 jwt&quot;">​</a></h2><ul><li>jwt 的原理是使用数字签名来验证和保护传输的信息</li><li>jwt的工作原理 <ul><li><strong>生成令牌（Token）</strong>：在用户身份验证成功后，服务器生成一个 JWT 令牌，并将其返回给客户端</li><li><strong>令牌结构</strong>：JWT 由三部分组成，即头部（Header）、载荷（Payload）和签名（Signature），它们通过点号分隔开。头部包含了关于令牌的元数据和签名算法信息，载荷包含了要传递的数据，签名用于验证令牌的完整性和真实性</li><li><strong>数字签名</strong>：服务器使用密钥对头部和载荷进行数字签名生成签名部分。签名通常使用 HMAC（Hash-based Message Authentication Code）或 RSA（Rivest-Shamir-Adleman）算法完成，以确保令牌的完整性和真实性</li><li><strong>传输令牌</strong>：服务器将生成的 JWT 令牌发送给客户端，通常通过在响应的 HTTP 头部中添加 &quot;Authorization&quot; 字段或放置在 Cookie 中</li><li><strong>请求验证</strong>：客户端在后续的请求中将 JWT 令牌作为授权凭证传递给服务器。通常，客户端会在请求的 HTTP 头部中添加 &quot;Authorization&quot; 字段，并将令牌以 Bearer 方式传递</li><li><strong>令牌验证</strong>：服务器接收到请求后，首先会解析 JWT 令牌，检查头部和载荷的完整性。然后，服务器使用相同的签名算法和密钥对头部和载荷进行验证，并与令牌中的签名部分进行比较。如果签名匹配，服务器可以确认令牌的真实性和完整性</li><li><strong>提取数据</strong>：一旦 JWT 令牌通过验证，服务器可以提取载荷中的数据，例如用户标识、权限等，并根据需要执行相应的操作</li></ul></li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">// middleware/auth.js</span></span>
<span class="line"><span style="color:#A6ACCD;">const { verify } = require(&#39;../util/jwt&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">const { jwtSecret } = require(&#39;../config/config.default&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">const { User } = require(&#39;../model&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">module.exports = async (req, res, next) =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">    // 从请求头获取 token 数据</span></span>
<span class="line"><span style="color:#A6ACCD;">    let token = req.headers[&#39;authorization&#39;]</span></span>
<span class="line"><span style="color:#A6ACCD;">    token = token ? token.split(&#39;Bearer &#39;)[1] : null</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    if (!token) {</span></span>
<span class="line"><span style="color:#A6ACCD;">        return res.status(401).end()</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    try {</span></span>
<span class="line"><span style="color:#A6ACCD;">        const decodedToken = await verify(token, jwtSecret)</span></span>
<span class="line"><span style="color:#A6ACCD;">        req.user = await User.findById(decodedToken.userId)</span></span>
<span class="line"><span style="color:#A6ACCD;">        next()</span></span>
<span class="line"><span style="color:#A6ACCD;">    } catch (err) {</span></span>
<span class="line"><span style="color:#A6ACCD;">        return res.status(401).end()</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    // 验证 token 是否有效</span></span>
<span class="line"><span style="color:#A6ACCD;">    // 无效 -&gt; 响应 401 状态码</span></span>
<span class="line"><span style="color:#A6ACCD;">    // 有效 -&gt; 把用户信息读取出来挂载到 req 请求对象上</span></span>
<span class="line"><span style="color:#A6ACCD;">    //        继续往后执行</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span></code></pre></div><h2 id="express-简单实现" tabindex="-1">express 简单实现 <a class="header-anchor" href="#express-简单实现" aria-label="Permalink to &quot;express 简单实现&quot;">​</a></h2><ul><li><code>createApplication</code> 是一个函数，具有<code>listen</code>、<code>use</code>、<code>all</code>及其他<code>method</code>上的方法</li><li><code>use</code>、<code>method</code>、<code>all</code> 收集<code>method</code>、<code>path</code>、<code>handler</code>在<code>app.routes</code>数组中</li><li><code>listen</code> 内部执行了<code>http.createServer</code>开启了一个服务端，其回调函数为<code>app</code>方法</li><li><code>app 方法原理</code><ul><li>实现一个<code>next</code>方法，每当匹配到对应的<code>method</code>和<code>path</code>时，就执行对应<code>handler</code></li></ul></li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">const http = require(&#39;http&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">const url = require(&#39;url&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">function createApplication() {</span></span>
<span class="line"><span style="color:#A6ACCD;">    // app 是 createServer 的回调函数</span></span>
<span class="line"><span style="color:#A6ACCD;">    let app = (req, res) =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">        // 获取请求的方法</span></span>
<span class="line"><span style="color:#A6ACCD;">        let methodName = req.method.toLowerCase()</span></span>
<span class="line"><span style="color:#A6ACCD;">        // 获取请求的路径</span></span>
<span class="line"><span style="color:#A6ACCD;">        let { pathname } = url.parse(req.url, true)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">        // 通过next方法进行中间件调用</span></span>
<span class="line"><span style="color:#A6ACCD;">        let index = 0</span></span>
<span class="line"><span style="color:#A6ACCD;">        function next(err) {</span></span>
<span class="line"><span style="color:#A6ACCD;">            if (index === app.routes.length) {</span></span>
<span class="line"><span style="color:#A6ACCD;">                return res.end(`Cannot find ${methodName} ${pathname}`)</span></span>
<span class="line"><span style="color:#A6ACCD;">            }</span></span>
<span class="line"><span style="color:#A6ACCD;">            let { method, path, handler } = app.routes[index++]</span></span>
<span class="line"><span style="color:#A6ACCD;">            if (err) {</span></span>
<span class="line"><span style="color:#A6ACCD;">                // 如果有错误，去找错误中间件</span></span>
<span class="line"><span style="color:#A6ACCD;">                // 错误中间件有四个参数</span></span>
<span class="line"><span style="color:#A6ACCD;">                if (handler.length === 4) {</span></span>
<span class="line"><span style="color:#A6ACCD;">                    handler(err, req, res, next)</span></span>
<span class="line"><span style="color:#A6ACCD;">                } else {</span></span>
<span class="line"><span style="color:#A6ACCD;">                    next(err)</span></span>
<span class="line"><span style="color:#A6ACCD;">                }</span></span>
<span class="line"><span style="color:#A6ACCD;">            } else {</span></span>
<span class="line"><span style="color:#A6ACCD;">                // next 就应该取下一个layer</span></span>
<span class="line"><span style="color:#A6ACCD;">                if (method === &#39;middle&#39;) {</span></span>
<span class="line"><span style="color:#A6ACCD;">                    // 处理中间件</span></span>
<span class="line"><span style="color:#A6ACCD;">                    if (path === &#39;/&#39; || path === pathname || pathname.startsWith(path + &#39;/&#39;)) {</span></span>
<span class="line"><span style="color:#A6ACCD;">                        handler(req, res, next)</span></span>
<span class="line"><span style="color:#A6ACCD;">                    }</span></span>
<span class="line"><span style="color:#A6ACCD;">                } else {</span></span>
<span class="line"><span style="color:#A6ACCD;">                    if ((method === methodName || method === &#39;all&#39;) &amp;&amp; (path === pathname || path === &#39;*&#39;)) {</span></span>
<span class="line"><span style="color:#A6ACCD;">                        return handler(req, res)</span></span>
<span class="line"><span style="color:#A6ACCD;">                    } else {</span></span>
<span class="line"><span style="color:#A6ACCD;">                        next()</span></span>
<span class="line"><span style="color:#A6ACCD;">                    }</span></span>
<span class="line"><span style="color:#A6ACCD;">                }</span></span>
<span class="line"><span style="color:#A6ACCD;">            }</span></span>
<span class="line"><span style="color:#A6ACCD;">        }</span></span>
<span class="line"><span style="color:#A6ACCD;">        next()</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    // 用于存放路由</span></span>
<span class="line"><span style="color:#A6ACCD;">    app.routes = []</span></span>
<span class="line"><span style="color:#A6ACCD;">    app.use = function (path, handler) {</span></span>
<span class="line"><span style="color:#A6ACCD;">        if (typeof handler !== &#39;function&#39;) {</span></span>
<span class="line"><span style="color:#A6ACCD;">            handler = path</span></span>
<span class="line"><span style="color:#A6ACCD;">            path = &#39;/&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">        }</span></span>
<span class="line"><span style="color:#A6ACCD;">        let layer = {</span></span>
<span class="line"><span style="color:#A6ACCD;">            method: &#39;middle&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">            path,</span></span>
<span class="line"><span style="color:#A6ACCD;">            handler</span></span>
<span class="line"><span style="color:#A6ACCD;">        }</span></span>
<span class="line"><span style="color:#A6ACCD;">        // 将中间件放到容器内</span></span>
<span class="line"><span style="color:#A6ACCD;">        app.routes.push(layer)</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">    // express 内置中间件</span></span>
<span class="line"><span style="color:#A6ACCD;">    app.use((req, res, next) =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">        let { pathname, query } = url.parse(req.url, true)</span></span>
<span class="line"><span style="color:#A6ACCD;">        let hostname = req.headers[&#39;host&#39;].split(&#39;:&#39;)[0]</span></span>
<span class="line"><span style="color:#A6ACCD;">        req.path = pathname</span></span>
<span class="line"><span style="color:#A6ACCD;">        req.hostname = hostname</span></span>
<span class="line"><span style="color:#A6ACCD;">        req.query = query</span></span>
<span class="line"><span style="color:#A6ACCD;">        next()</span></span>
<span class="line"><span style="color:#A6ACCD;">    })</span></span>
<span class="line"><span style="color:#A6ACCD;">    // 实现 all 路由方法</span></span>
<span class="line"><span style="color:#A6ACCD;">    app.all = function (path, handler) {</span></span>
<span class="line"><span style="color:#A6ACCD;">        let layer = {</span></span>
<span class="line"><span style="color:#A6ACCD;">            method: &#39;all&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">            path,</span></span>
<span class="line"><span style="color:#A6ACCD;">            handler</span></span>
<span class="line"><span style="color:#A6ACCD;">        }</span></span>
<span class="line"><span style="color:#A6ACCD;">        app.routes.push(layer)</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">    // 实现路由方法</span></span>
<span class="line"><span style="color:#A6ACCD;">    http.METHODS.forEach(method =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">        method = method.toLocaleLowerCase()</span></span>
<span class="line"><span style="color:#A6ACCD;">        app[method] = function (path, handler) {</span></span>
<span class="line"><span style="color:#A6ACCD;">            // layer 记录 method+path =&gt; handler</span></span>
<span class="line"><span style="color:#A6ACCD;">            let layer = {</span></span>
<span class="line"><span style="color:#A6ACCD;">                method,</span></span>
<span class="line"><span style="color:#A6ACCD;">                path,</span></span>
<span class="line"><span style="color:#A6ACCD;">                handler</span></span>
<span class="line"><span style="color:#A6ACCD;">            }</span></span>
<span class="line"><span style="color:#A6ACCD;">            app.routes.push(layer)</span></span>
<span class="line"><span style="color:#A6ACCD;">        }</span></span>
<span class="line"><span style="color:#A6ACCD;">    })</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    // 生成一个服务端</span></span>
<span class="line"><span style="color:#A6ACCD;">    app.listen = function () {</span></span>
<span class="line"><span style="color:#A6ACCD;">        const server = http.createServer(app)</span></span>
<span class="line"><span style="color:#A6ACCD;">        server.listen(...arguments)</span></span>
<span class="line"><span style="color:#A6ACCD;">    }</span></span>
<span class="line"><span style="color:#A6ACCD;">    return app</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">module.exports = createApplication</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-a3c25e27 data-v-5774f702><!--[--><!--]--><div class="edit-info" data-v-5774f702><!----><div class="last-updated" data-v-5774f702><p class="VPLastUpdated" data-v-5774f702 data-v-b89b6307>Last updated: <time datetime="2023-08-20T12:23:35.000Z" data-v-b89b6307></time></p></div></div><nav class="prev-next" data-v-5774f702><div class="pager" data-v-5774f702><a class="pager-link prev" href="/blog/node/mongoDB.html" data-v-5774f702><span class="desc" data-v-5774f702>Previous page</span><span class="title" data-v-5774f702>mongoDB</span></a></div><div class="pager" data-v-5774f702><a class="pager-link next" href="/blog/node/koa.html" data-v-5774f702><span class="desc" data-v-5774f702>Next page</span><span class="title" data-v-5774f702>koa</span></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"readme.en.md\":\"eaadeb5d\",\"interview_monitor.md\":\"79b39e4f\",\"article_project_rollup_vite.md\":\"b8518f6c\",\"interview_css.md\":\"2d3d234d\",\"alg_sorting.md\":\"a154f413\",\"alg_dobulepointer.md\":\"10fe8b2e\",\"interview_softskill.md\":\"a807d4aa\",\"article_wheel_lazyload.md\":\"a0116601\",\"article_react_reactusecss.md\":\"a6adaacf\",\"article_project_webpackconfig.md\":\"72ec81d1\",\"index.md\":\"a4192508\",\"alg_range.md\":\"8d32dc43\",\"readme.md\":\"9fe2bbf2\",\"interview_miniwechat.md\":\"d977b9d2\",\"interview_experience.md\":\"e0b2e576\",\"alg_stack.md\":\"17dd5b1b\",\"node_nodebasic.md\":\"08b016d6\",\"article_wheel_scrolllist.md\":\"bff814f0\",\"article_react_reactusets.md\":\"2fea022f\",\"article_vuecomponent_bem.md\":\"f76ce9fa\",\"article_project_normalizeconfig.md\":\"39d23d0b\",\"article_project_modulestandard.md\":\"a4d90dae\",\"node_express.md\":\"9049c5ac\",\"article_vuecomponent_usets.md\":\"180b5915\",\"alg_slidewindow.md\":\"93e95a53\",\"article_requirement_binary.md\":\"1e140587\",\"article_react_reactbasic.md\":\"8e73c160\",\"alg_array.md\":\"285e035c\",\"article_vuecomponent_monorepo.md\":\"4e04216a\",\"interview_performance.md\":\"4bea50a3\",\"node_mongodb.md\":\"f60d5598\",\"article_react_reacthooks.md\":\"a7b6f542\",\"interview_vue.md\":\"60363d6c\",\"alg_hash.md\":\"0ed1699c\",\"interview_network.md\":\"f266486d\",\"interview_codeconsole.md\":\"126c0a41\",\"interview_browser.md\":\"e4f87485\",\"node_koa.md\":\"cce0fcff\",\"article_requirement_upload.md\":\"1e075c3d\",\"interview_html.md\":\"5e20e85b\",\"interview_writecode.md\":\"66b6deb5\",\"interview_javascript.md\":\"6a379c53\",\"interview_networkinterview.md\":\"6d09c46c\",\"interview_typescript.md\":\"91b27097\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"well's blog\",\"description\":\"well's blog\",\"base\":\"/blog/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"lastUpdated\":\"最后更新时间\",\"docsDir\":\"docs\",\"editLinks\":true,\"editLinkText\":\"编辑此网站\",\"repo\":\"https://gitee.com/wayliuhaha/blog\",\"nav\":[{\"text\":\"文档\",\"link\":\"/article/project/normalizeConfig\",\"activeMatch\":\"/article/\"},{\"text\":\"node\",\"link\":\"/node/nodeBasic\",\"activeMatch\":\"/node/\"},{\"text\":\"不止于面试\",\"link\":\"/interview/css\",\"activeMatch\":\"/interview/\"},{\"text\":\"算法\",\"link\":\"/alg/array\",\"activeMatch\":\"/alg/\"}],\"sidebar\":{\"/node/\":[{\"text\":\"node 基础\",\"link\":\"/node/nodeBasic\"},{\"text\":\"mongoDB\",\"link\":\"/node/mongoDB\"},{\"text\":\"express\",\"link\":\"/node/express\"},{\"text\":\"koa\",\"link\":\"/node/koa\"}],\"/article/\":[{\"text\":\"文档\",\"items\":[{\"text\":\"项目工程化\",\"items\":[{\"text\":\"规范化配置\",\"link\":\"/article/project/normalizeConfig\"},{\"text\":\"打包工具-webpack\",\"link\":\"/article/project/webpackConfig\"},{\"text\":\"rollup&webpack\",\"link\":\"/article/project/rollup&vite\"},{\"text\":\"前端模块化规范\",\"link\":\"/article/project/moduleStandard\"}]},{\"text\":\"轮子原理\",\"items\":[{\"text\":\"图片懒加载\",\"link\":\"/article/wheel/lazyload\"},{\"text\":\"虚拟滚动列表\",\"link\":\"/article/wheel/scrollList\"}]},{\"text\":\"vue3 通用组件\",\"items\":[{\"text\":\"Monorepo\",\"link\":\"/article/vueComponent/monorepo\"},{\"text\":\"ts 类型约束\",\"link\":\"/article/vueComponent/usets \"},{\"text\":\"BEM 规范\",\"link\":\"/article/vueComponent/bem\"}]},{\"text\":\"React\",\"items\":[{\"text\":\"react 基础\",\"link\":\"/article/react/reactBasic\"},{\"text\":\"react hooks\",\"link\":\"/article/react/reactHooks\"},{\"text\":\"react 使用ts指南\",\"link\":\"/article/react/reactUseTs\"},{\"text\":\"react 使用css\",\"link\":\"/article/react/reactUseCss\"}]},{\"text\":\"常见需求处理\",\"items\":[{\"text\":\"二进制\",\"link\":\"/article/requirement/binary\"},{\"text\":\"文件上传\",\"link\":\"/article/requirement/upload\"}]}]}],\"/interview\":[{\"text\":\"不止于面试\",\"items\":[{\"text\":\"css\",\"link\":\"/interview/css\"},{\"text\":\"html\",\"link\":\"/interview/html\"},{\"text\":\"javascript\",\"link\":\"/interview/javascript\"},{\"text\":\"typescript\",\"link\":\"/interview/typescript\"},{\"text\":\"vue\",\"link\":\"/interview/vue\"},{\"text\":\"代码输出\",\"link\":\"/interview/codeconsole\"},{\"text\":\"手写代码\",\"link\":\"/interview/writecode\"},{\"text\":\"浏览器原理\",\"link\":\"/interview/browser\"},{\"text\":\"计算机网络\",\"link\":\"/interview/network\"},{\"text\":\"计算机网络（面试）\",\"link\":\"/interview/networkinterview\"},{\"text\":\"微信小程序\",\"link\":\"/interview/miniwechat\"},{\"text\":\"性能优化\",\"link\":\"/interview/performance\"},{\"text\":\"监控平台\",\"link\":\"/interview/monitor\"},{\"text\":\"软技能\",\"link\":\"/interview/softskill\"},{\"text\":\"面经\",\"link\":\"/interview/experience\"}]}],\"/alg\":[{\"text\":\"算法\",\"items\":[{\"text\":\"数组/字符串\",\"link\":\"/alg/array\"},{\"text\":\"滑动窗口\",\"link\":\"/alg/slidewindow\"},{\"text\":\"哈希表\",\"link\":\"/alg/hash\"},{\"text\":\"双指针\",\"link\":\"/alg/dobulePointer\"},{\"text\":\"栈\",\"link\":\"/alg/stack\"},{\"text\":\"区间\",\"link\":\"/alg/range\"},{\"text\":\"排序算法\",\"link\":\"/alg/sorting\"}]}]}},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}");</script>
    
  </body>
</html>